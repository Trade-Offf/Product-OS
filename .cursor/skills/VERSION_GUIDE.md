# PRD版本化指南

> **作用**: 为 `02-PRD生成.md` 技能提供版本化逻辑的详细说明。

---

## 📋 版本化规则

### 文件命名格式

```
03_Output/PRD_{功能名}_v{版本号}_{日期}.md
```

**示例**:
- `PRD_pnl_share_v1.0_20260129.md` - 初版
- `PRD_pnl_share_v1.1_20260130.md` - 小版本更新  
- `PRD_pnl_share_v2.0_20260205.md` - 大版本更新

---

## 🔢 版本号计算规则

### 版本递增逻辑

| 场景 | 版本递增规则 | 示例 |
|------|------------|------|
| **首次生成** | v1.0 | - |
| **小改动** | 次版本号 +0.1 | v1.0 → v1.1 |
| **大改动** | 主版本号 +1.0 | v1.1 → v2.0 |

### 判断依据

**大改动 (Major Change)**:
- ✅ 新增功能模块 (如新增"移动端"章节)
- ✅ 重构业务逻辑 (如改变核心流程)
- ✅ 删除已有功能
- ✅ 变更端定义 (如Web端改为App端)

**小改动 (Minor Change)**:
- ✅ 补充细节描述
- ✅ 回答待确认问题
- ✅ 调整文案措辞
- ✅ 增加图片说明
- ✅ 修复错别字

---

## 🎯 执行流程

### Step 1: 扫描现有版本

```bash
扫描 03_Output/ 目录
查找匹配 PRD_{功能名}_v*.md 的文件
提取最新版本号
```

**示例**:
```
03_Output/
├── PRD_pnl_share_v1.0_20260128.md  ← 旧版本
├── PRD_pnl_share_v1.1_20260129.md  ← 当前最新版本
└── test_cases_pnl_share_20260129.md
```

**结论**: 当前最新版本 = `v1.1`

### Step 2: 对比差异

读取 `_WORK_SHEET.md` 和最新版PRD，对比：
- Part 1 中新回答的问题数量
- Part 2 中新增的章节/功能模块
- 原有章节的修改程度

### Step 3: 计算新版本号

```
如果: 新增章节 > 0 OR 删除章节 > 0
  → 大改动 → v1.1 变为 v2.0

否则: 
  → 小改动 → v1.1 变为 v1.2
```

### Step 4: 生成文档

- 生成文件名: `PRD_{功能名}_v{新版本号}_{今日日期}.md`
- 在文档头部添加版本历史表
- 保存到 `03_Output/` 目录

---

## 📚 版本历史表格式

在PRD文档头部添加：

```markdown
## 📚 版本历史

| 版本 | 日期 | 主要变更 |
|------|------|---------|
| v2.0 | 2026-01-30 | 新增移动端功能模块 |
| v1.2 | 2026-01-29 | 补充白名单规则细节、增加异常流程说明 |
| v1.1 | 2026-01-29 | 回答Q1-Q3问题、补充图片说明 |
| v1.0 | 2026-01-28 | 初版发布 |
```

---

## ✅ 自检清单

生成PRD前必须检查：

- [ ] 是否扫描了 `03_Output/` 目录查找现有版本？
- [ ] 版本号是否正确递增？（小改动+0.1，大改动+1.0）
- [ ] 文件名是否包含版本号和日期？
- [ ] 是否在文档头部添加了版本历史表？
- [ ] 旧版本文件是否保留（不删除）？
- [ ] 本次变更摘要是否准确填写？

---

## 🎲 特殊场景处理

### 场景1: 功能名称变更

如果功能名称从 `user_whitelist` 变更为 `whitelist_管理`:
- 新文件: `PRD_whitelist_management_v1.0_20260130.md`
- 旧文件保留，不重命名

### 场景2: 多次小改动后的大改动

```
v1.0 → v1.1 → v1.2 → v2.0 (大改动)
```

即使已经到v1.9，大改动仍然变为v2.0，而不是v1.10

### 场景3: 当天多次生成

同一天生成多次PRD：
- 第1次: `PRD_xxx_v1.0_20260129.md`
- 第2次: `PRD_xxx_v1.1_20260129.md` (同一天，版本号递增)

**文件名中的日期 = 生成日期**，不会重复

---

_Last Updated: 2026-01-29_
