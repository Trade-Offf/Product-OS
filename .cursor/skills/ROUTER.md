# 技能路由表 (Skill Router)

> **作用**: 统一管理所有技能的触发词、执行顺序、依赖关系。所有触发词的单一来源 (Single Source of Truth)。

---

## 🎯 核心链路 (Core Flow)

### 01 - 需求拆解 (Logic Extractor)

**触发词**:
- "整理"
- "整理一下"
- "拆解"
- "拆解需求"
- "提取逻辑"

**技能文件**: `.cursor/skills/Core_Flow/01-需求拆解.md`

**输出路径**: `_WORK_SHEET.md` (项目根目录)

**依赖检查**:
- ✅ 必须存在: `01_Input/` 目录下有输入文件
- ❌ 可选依赖: 无

**执行说明**:
- 读取 `01_Input/` 下的所有文档（.md / .pdf / 图片描述）
- 生成结构化的工作台文件 `_WORK_SHEET.md`
- 提取待确认问题到 Part 1，详细拆解报告到 Part 2

---

### 02 - PRD生成 (PRD Generator)

**触发词**:
- "生成文档"
- "生成PRD"
- "融合"
- "合并"
- "出文档"

**技能文件**: `.cursor/skills/Core_Flow/02-PRD生成.md`

**输出路径**: `03_Output/PRD_{功能名}_v{版本号}_{日期}.md`

**依赖检查**:
- ✅ 必须存在: `_WORK_SHEET.md` (工作台文件)
- ⚠️ 如果缺失: 提示用户先执行"整理一下"

**执行说明**:
- 读取 `_WORK_SHEET.md` 的 Part 1 (决策) 和 Part 2 (逻辑)
- 读取 `01_Input/` 下的图片索引 (如有)
- 生成版本化的正式PRD文档
- 自动计算版本号和生成日期

---

## 🛠️ 可选工具 (Optional Tools)

### 01 - 后台界面生成 (Admin UI Generator)

**触发词**:
- "画后台"
- "画管理后台"
- "预览"
- "生成界面"
- "生成页面"
- "看看效果"

**技能文件**: `.cursor/skills/Optional_Tools/01-后台界面生成.md`

**输出路径**: `03_Output/preview_admin_{功能名}_{日期}.html`

**依赖检查**:
- ✅ 必须存在: `_WORK_SHEET.md` 或 `03_Output/PRD_*.md`
- ⚠️ 如果缺失: 提示用户先执行"整理"或"生成文档"

**特殊说明**:
- 只生成**后台管理系统**界面，不做C端/App界面
- 输出为单文件HTML，双击可直接运行

---

### 02 - Mermaid流程图 (Diagram Maker)

**触发词**:
- "画图"
- "画个图"
- "流程图"
- "时序图"
- "状态图"
- "Mermaid"

**技能文件**: `.cursor/skills/Optional_Tools/02-Mermaid流程图.md`

**输出路径**: `02_Process/diagrams/diagram_{类型}_{功能名}_{日期}.md`

**依赖检查**:
- ✅ 必须存在: `_WORK_SHEET.md` 或 `03_Output/PRD_*.md`
- ⚠️ 如果缺失: 提示用户先执行"整理"或"生成文档"

**执行说明**:
- 根据内容自动判断图表类型（流程图/时序图/状态图/ER图）
- 如发现流程逻辑缺口，追加问题到 `_WORK_SHEET.md` Part 1

---

### 03 - 评审模拟 (Review Simulator)

**触发词**:
- "评审"
- "评审一下"
- "找漏洞"
- "挑毛病"
- "Challenge"
- "模拟评审"

**技能文件**: `.cursor/skills/Optional_Tools/03-评审模拟.md`

**输出路径**: `02_Process/reviews/review_report_{日期}.md`

**依赖检查**:
- ✅ 必须存在: `_WORK_SHEET.md` 或 `03_Output/PRD_*.md`
- ⚠️ 如果缺失: 提示用户先执行"整理"或"生成文档"

**执行说明**:
- 以后端、前端、QA三个角色视角进行评审
- 如发现逻辑缺口或技术风险，追加问题到 `_WORK_SHEET.md` Part 1

---

## 🔄 组合技能 (Combined Skills)

当用户使用组合指令时，按以下顺序执行：

### "整理并生成文档"
```
执行顺序: 01-需求拆解 → 提示用户填写问题 → (等待) → 02-PRD生成
```

### "全流程"
```
执行顺序: 01-需求拆解 → (等待用户填写) → 02-PRD生成 → 02-Mermaid流程图 → 03-评审模拟
```

---

## 📋 文件路径规范 (File Path Convention)

### 固定路径
```
_WORK_SHEET.md                      → 项目根目录（工作台）
01_Input/                           → 原始输入文件
02_Process/                         → AI加工中间产物
  ├── diagrams/                     → 流程图目录
  │   └── diagram_{类型}_{功能名}_{日期}.md
  └── reviews/                      → 评审报告目录
      └── review_report_{日期}.md
03_Output/                          → 最终交付物
  ├── PRD_{功能名}_v{版本}_{日期}.md  → 正式PRD
  └── artifacts/                    → 其他制品（HTML等）
      └── preview_admin_{功能名}_{日期}.html
```

### 命名规范
- **日期格式**: `YYYYMMDD` (例: `20260129`)
- **版本格式**: `v1.0`, `v1.1`, `v2.0` (遵循语义化版本)
- **功能名**: 使用下划线连接，避免空格 (例: `pnl_share`, `user_whitelist`)

---

## 🔍 技能依赖检查流程

在执行技能前，AI必须执行以下检查：

1. **读取路由表**: 确认触发词对应的技能文件
2. **检查依赖**: 验证必须依赖的文件是否存在
3. **执行技能**: 如果依赖满足，读取技能文件并执行
4. **提示用户**: 如果依赖缺失，给出明确提示

**示例提示语**:
```
⚠️ 评审功能需要先完成需求拆解，请先说"整理一下"

⚠️ PRD生成需要先有工作台文件，请先说"整理一下"并填写待确认问题

✅ 依赖检查通过，开始执行技能...
```

---

## 📝 维护说明

### 添加新技能时
1. 在对应目录创建技能文件 (Core_Flow 或 Optional_Tools)
2. 在本文件添加路由配置
3. 更新 `.cursorrules` 引用此路由表
4. 不要在技能文件中重复定义触发词

### 修改触发词时
- ✅ 只在本文件修改
- ❌ 不要在 `.cursorrules` 或技能文件中修改

---

_Last Updated: 2026-01-29_
