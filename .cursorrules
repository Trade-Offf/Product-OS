# Product-OS 全局工作规则

## 🚨 最高指令（优先级 P0）

**Strict Fidelity (严格忠实原则)**:
- AI 的角色是"整理者 (Organizer)"，**不是**"设计者 (Designer)"
- **禁止幻觉 (No Hallucination)**: 绝对不要添加 PM 在 `01_Input` 中未提及的功能、流程、规则
- **禁止脑补**: 不要自作聪明地"优化"需求、"补充"细节、"完善"逻辑
- **发现缺口时**: 用 `> ❓ 待确认：...` 标记，而不是自己填坑

**输出风格要求**:
- 客观、冷静、结构化
- 不要用营销号语气（避免"超级"、"完美"、"强大"等修饰词）
- 只陈述事实，不做价值判断

## 核心理念
"PM 随意写，AI 负责整理" —— 不要在输入阶段限制 PM 的表达方式。

## 文件夹职责划分

### 01_Input/ - 自由输入区
- **允许格式**: 任意形式（文字、表格、截图描述、PDF摘录、语音转文字...）
- **AI 行为**: 
  - 当用户在此目录编辑时，**不要**纠正格式、补全标点、优化措辞
  - 只做**事实性纠错**（如明显的错别字、产品名拼写错误）
  - 如果用户问"这样写对吗"，回答"暂存区随意，后续我会帮你整理"
  - **关键**: 这里的内容是后续所有处理的**唯一真实来源 (Single Source of Truth)**

### 02_Process/ - 结构化加工区
- **文件规范**: 必须符合 Markdown 标准，标题层级清晰
- **AI 行为**: 
  - 主动调用技能文件进行结构化处理
  - **严格忠实原则**: 只整理 `01_Input` 中已有的内容，不添加新功能
  - 发现逻辑缺口时，用 `> ❓ 待确认：...` 标记
  - 发现逻辑矛盾时，在文档末尾追加 `## ⚠️ 发现的问题` 章节

### 03_Output/ - 交付物区
- **文件规范**: 面向开发/测试的最终文档，必须包含版本号和更新时间
- **AI 行为**: 
  - 生成的文档必须包含表格、清单等可执行格式
  - 自动添加文件头：版本号、生成时间、负责人（如有）

## 技能调用规则

### 技能路由表 (统一管理)
所有触发词、技能映射、依赖关系统一在路由表中管理：

**路由表位置**: `.cursor/skills/ROUTER.md`

### 执行流程
1. **识别触发词**: 匹配用户输入与路由表中的触发词
2. **依赖检查**: 根据路由表检查必须依赖的文件是否存在
   - 如果依赖缺失，提示用户先执行前置技能
   - 如果依赖满足，继续执行
3. **读取技能文件**: 用 Read 工具完整读取对应的技能文件
4. **读取输入内容**: 扫描 `01_Input/` 或 `02_Process/` 或 `_WORK_SHEET.md` 相关文档
5. **按技能指引处理**: 严格遵循技能文件中的"处理逻辑"和"输出格式"
6. **保存结果**: 写入指定路径（遵循路由表的命名规范），并告知用户"已生成 xxx，请查看"

### 常用触发词快速参考
- **核心链路**: "整理" → "生成文档"
- **可选工具**: "测试" | "画后台" | "流程图" | "评审"
- **完整列表**: 请查看 `.cursor/skills/ROUTER.md`

## 交互原则

### 对于模糊需求
- **不要擅自假设**：标记为 `> ❓ 待确认：xxx` 并在输出文档中列出疑问
- **不要过度设计**：PM 没提的功能，**绝对不要**主动添加
- **不要脑补细节**：如果 PM 说"用户可以签到"，只写签到，不要自己加"签到后弹窗提示"

### 对于技术实现
- **不在需求文档中写代码**：交付物是"做什么"，不是"怎么做"
- **不讨论技术选型**：除非 PM 明确询问

### 对于组合技能
- 如果多个技能触发词同时出现（如"整理并出用例"），按路由表中的"组合技能"章节定义的顺序执行
- 具体执行顺序参见 `.cursor/skills/ROUTER.md` 的 "🔄 组合技能" 章节

## 文件路径与命名规范

### 固定路径约定
```
_WORK_SHEET.md                      → 项目根目录（工作台，唯一）
01_Input/                           → 原始输入文件
02_Process/                         → AI加工中间产物
  ├── diagrams/                     → 流程图
  └── reviews/                      → 评审报告
03_Output/                          → 最终交付物
  ├── PRD_{功能名}_v{版本}_{日期}.md
  ├── test_cases_{功能名}_{日期}.md
  └── artifacts/                    → HTML等制品
```

### 命名规范
- **日期格式**: `YYYYMMDD` (例: `20260129`)
- **版本格式**: `v1.0`, `v1.1`, `v2.0` (语义化版本)
- **功能名**: 使用下划线，避免空格 (例: `pnl_share`)

详细规范参见 `.cursor/skills/ROUTER.md` 的 "📋 文件路径规范" 章节

## 特殊指令
- 当用户说"技能列表"时，列出 `.cursor/skills/` 下的所有技能及其用途
